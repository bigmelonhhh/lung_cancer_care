{% extends "layouts/base_portal.html" %}

{% block body %}
<div class="min-h-screen bg-slate-100 pb-safe-bottom font-sans">
    <!-- Header Section -->
    <div class="bg-[#4DB6AC] pt-safe-top pb-16 px-5 rounded-b-[2rem] shadow-md relative">
        <div class="flex items-center gap-4 pt-6 relative z-10">
            <!-- Avatar -->
            <div class="w-16 h-16 rounded-full bg-white flex items-center justify-center text-[#4DB6AC] text-2xl font-bold shadow-inner border-2 border-white/50">
                <svg class="w-10 h-10" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
            </div>
            <!-- Doctor Info -->
            <div class="text-white">
                <div class="flex items-end gap-2">
                    <h1 class="text-xl font-bold">{{ doctor.name }}</h1>
                    <span class="text-sm font-medium opacity-90">{{ doctor.title }}</span>
                </div>
                <p class="text-sm font-medium mt-1 opacity-90">{{ doctor.department }}</p>
                <p class="text-xs mt-0.5 opacity-75">{{ doctor.hospital }}</p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="px-4 -mt-10 relative z-20 space-y-4">
        
        <!-- Stats Card -->
        <div class="bg-white rounded-xl shadow-sm p-4 flex items-center divide-x divide-slate-100">
            <div class="flex-1 text-center">
                <p class="text-xs text-slate-500 font-bold mb-1">管理患者</p>
                <p class="text-lg font-bold text-slate-800">{{ stats.managed_patients }} <span class="text-xs font-normal text-slate-400">人</span></p>
            </div>
            <div class="flex-1 text-center">
                <p class="text-xs text-slate-500 font-bold mb-1">今日活跃</p>
                <p class="text-lg font-bold text-slate-800">{{ stats.today_active }} <span class="text-xs font-normal text-slate-400">人</span></p>
            </div>
        </div>

        <!-- Alerts Section -->
        <div class="rounded-xl overflow-hidden shadow-sm">
            <div class="bg-[#E57373] px-4 py-2 flex items-center gap-2 text-white">
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                <span class="font-bold text-sm">患者异常警报 ({{ stats.alerts_count }})</span>
            </div>
            <div class="bg-white p-2 space-y-2">
                {% for alert in alerts %}
                <div class="bg-white border-b border-slate-50 last:border-0 p-3 flex items-center justify-between active:bg-slate-50 transition">
                    <div class="flex items-center gap-2">
                        <span class="text-red-500">
                            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-bold text-slate-700">{{ alert.patient_name }} - {{ alert.type }}</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-slate-400">{{ alert.time }}</span>
                        <svg class="w-4 h-4 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                    </div>
                </div>
                {% empty %}
                <div class="p-4 text-center text-slate-400 text-sm">暂无异常警报</div>
                {% endfor %}
            </div>
        </div>

        <!-- Consultations Section -->
        <div class="rounded-xl overflow-hidden shadow-sm">
            <div class="bg-[#FBC02D] px-4 py-2 flex items-center gap-2 text-white">
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/>
                </svg>
                <span class="font-bold text-sm">患者咨询 ({{ stats.consultations_count }})</span>
            </div>
            <div class="bg-white p-2 space-y-2">
                {% for item in consultations %}
                <div class="bg-white border-b border-slate-50 last:border-0 p-3 flex items-center justify-between active:bg-slate-50 transition">
                    <div class="flex items-center gap-2 overflow-hidden">
                        <span class="text-yellow-500 shrink-0">
                            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </span>
                        <div class="truncate text-sm text-slate-700">
                            <span class="font-bold">{{ item.patient_name }}</span> - "{{ item.content }}"
                        </div>
                    </div>
                    <div class="flex items-center gap-2 shrink-0">
                        <span class="text-xs text-slate-400">{{ item.time }}</span>
                        <svg class="w-4 h-4 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                    </div>
                </div>
                {% empty %}
                <div class="p-4 text-center text-slate-400 text-sm">暂无咨询消息</div>
                {% endfor %}
            </div>
        </div>

        <!-- Bottom Actions -->
        <div class="grid grid-cols-2 gap-4 pt-2">
            <!-- Patient Management -->
            <a href="#" class="bg-white p-6 rounded-xl shadow-sm flex flex-col items-center justify-center gap-3 active:scale-95 transition h-32">
                <div class="w-12 h-12 rounded-full bg-[#4DB6AC]/10 flex items-center justify-center text-[#4DB6AC]">
                    <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                </div>
                <span class="font-bold text-slate-700">患者管理</span>
            </a>
            
            <!-- My Assistant -->
            <a href="#" class="bg-white p-6 rounded-xl shadow-sm flex flex-col items-center justify-center gap-3 active:scale-95 transition h-32">
                <div class="w-12 h-12 rounded-full bg-[#4DB6AC]/10 flex items-center justify-center text-[#4DB6AC]">
                    <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1V19z"/>
                    </svg>
                </div>
                <span class="font-bold text-slate-700">我的助理</span>
            </a>
        </div>
    </div>
</div>
{% endblock %}
